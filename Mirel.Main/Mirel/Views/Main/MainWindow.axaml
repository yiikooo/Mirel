<u:UrsaWindow
    Background="Transparent"
    CanMaximize="False"
    CanMinimize="False"
    CanResize="True"
    DragDrop.AllowDrop="True"
    FontFamily="{DynamicResource MiSans}"
    FontWeight="{DynamicResource FontWeight}"
    Icon="../../Icon.NoMargin.ico"
    IsCloseButtonVisible="False"
    IsFullScreenButtonVisible="False"
    IsHitTestVisible="True"
    IsTitleBarVisible="False"
    MinHeight="250"
    MinWidth="450"
    SystemDecorations="Full"
    Title="Aurelio"
    WindowStartupLocation="CenterScreen"
    d:DesignHeight="450"
    d:DesignWidth="800"
    mc:Ignorable="d"
    x:Class="Mirel.Views.Main.MainWindow"
    x:DataType="viewModels:MainViewModel"
    xmlns="https://github.com/avaloniaui"
    xmlns:behavior="clr-namespace:Mirel.Module.Behavior"
    xmlns:controls="clr-namespace:Mirel.Controls"
    xmlns:converter="clr-namespace:Mirel.Module.Converter"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:entries="clr-namespace:Mirel.Classes.Entries"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:u="https://irihi.tech/ursa"
    xmlns:viewModels="clr-namespace:Mirel.ViewModels"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <u:UrsaWindow.Resources>
        <converter:NavScrollOpacityMaskConverter x:Key="NavScrollOpacityMaskConverter" />
    </u:UrsaWindow.Resources>
    <Border
        Background="{DynamicResource WindowBackgroundColor}"
        BorderBrush="{DynamicResource BorderBrush}"
        BorderThickness="1"
        ClipToBounds="True"
        CornerRadius="8"
        x:Name="Root">
        <DockPanel>
            <Grid>
                <DockPanel>
                    <Border
                        ClipToBounds="True"
                        DockPanel.Dock="Top"
                        VerticalAlignment="Top">
                        <Grid>
                            <controls:TitleBar
                                DockPanel.Dock="Top"
                                IsCloseBtnExitApp="True"
                                IsCloseBtnShow="True"
                                IsMaxBtnShow="True"
                                IsVisible="True"
                                Name="TitleBar">
                                <controls:TitleBar.LeftContent>
                                    <StackPanel Name="TitleBarContainer" Orientation="Horizontal">
                                        <Button
                                            Classes="title-bar-button big-title-bar-icon"
                                            Content="M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336a80 80 0 1 0 0-160 80 80 0 1 0 0 160z"
                                            Name="SettingButton"
                                            VerticalAlignment="Center" />
                                        <Button
                                            Classes="title-bar-button-more"
                                            Content="M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z"
                                            Name="MoreButton"
                                            VerticalAlignment="Center" />
                                        <Separator
                                            Background="{DynamicResource TabTextColor}"
                                            Foreground="{DynamicResource TabTextColor}"
                                            Height="16"
                                            Margin="5,0,5,0"
                                            Name="Separator"
                                            VerticalAlignment="Center"
                                            Width="1" />
                                    </StackPanel>
                                </controls:TitleBar.LeftContent>
                            </controls:TitleBar>
                            <Border
                                Background="Transparent"
                                ClipToBounds="True"
                                DockPanel.Dock="Top"
                                Height="40"
                                HorizontalAlignment="Left"
                                Margin="80,0,150,0"
                                Name="NavRoot"
                                VerticalAlignment="Top">
                                <Grid>
                                    <ScrollViewer
                                        AllowAutoHide="True"
                                        HorizontalScrollBarVisibility="Auto"
                                        Name="NavScrollViewer"
                                        Offset="{Binding TabScrollOffset}"
                                        OpacityMask="{Binding IsTabMaskVisible, Converter={StaticResource NavScrollOpacityMaskConverter}}"
                                        PointerWheelChanged="NavScrollViewer_PointerWheelChanged"
                                        VerticalScrollBarVisibility="Disabled">
                                        <StackPanel Margin="0,0,20,0" Orientation="Horizontal">
                                            <u:SelectionList
                                                AutoScrollToSelectedItem="True"
                                                ItemsSource="{Binding Tabs}"
                                                Name="NavMenu"
                                                SelectedItem="{Binding SelectedTab, Mode=TwoWay}"
                                                VerticalAlignment="Center">
                                                <u:SelectionList.Styles>
                                                    <Style Selector="u|SelectionListItem:not(:selected)">
                                                        <Style Selector="^ TextBlock">
                                                            <Setter Property="Foreground" Value="{DynamicResource TextColor}" />
                                                        </Style>
                                                        <Style Selector="^ Button">
                                                            <Setter Property="Opacity" Value="0" />
                                                        </Style>
                                                        <Style Selector="^ Border#ItemRoot">
                                                            <Setter Property="Background" Value="{DynamicResource TabBackgroundColor}" />
                                                            <Setter Property="BorderBrush" Value="{DynamicResource LinearGradientTransparentColor}" />
                                                        </Style>
                                                    </Style>
                                                    <Style Selector="u|SelectionListItem:pointerover">
                                                        <Style Selector="^ Button">
                                                            <Setter Property="Opacity" Value="1" />
                                                        </Style>
                                                        <Style Selector="^ Border#ItemRoot">
                                                            <Setter Property="Background" Value="{DynamicResource HoverTabBackgroundColor}" />
                                                            <Setter Property="BorderBrush" Value="{DynamicResource LinearGradientTransparentColor}" />
                                                        </Style>
                                                    </Style>
                                                    <Style Selector="u|SelectionListItem:selected">
                                                        <Style Selector="^ Button">
                                                            <Setter Property="Opacity" Value="1" />
                                                        </Style>
                                                        <Style Selector="^ Border#ItemRoot">
                                                            <Setter Property="Background" Value="{DynamicResource SelectedTabBackgroundColor}" />
                                                            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}" />
                                                        </Style>
                                                    </Style>
                                                </u:SelectionList.Styles>
                                                <u:SelectionList.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <StackPanel Orientation="Horizontal" Spacing="5" />
                                                    </ItemsPanelTemplate>
                                                </u:SelectionList.ItemsPanel>
                                                <u:SelectionList.Indicator>
                                                    <Border
                                                        Background="{DynamicResource PageBackgroundColor}"
                                                        BorderBrush="{DynamicResource BorderBrush}"
                                                        BorderThickness="1"
                                                        CornerRadius="5"
                                                        HorizontalAlignment="Stretch"
                                                        IsVisible="False"
                                                        Margin="3"
                                                        VerticalAlignment="Stretch" />
                                                </u:SelectionList.Indicator>
                                                <u:SelectionList.ItemTemplate>
                                                    <DataTemplate DataType="entries:TabEntry">
                                                        <Border
                                                            BorderThickness="1"
                                                            CornerRadius="{DynamicResource CardCornerRadius}"
                                                            Height="30"
                                                            MinWidth="140"
                                                            Name="ItemRoot"
                                                            PointerPressed="TabItem_OnPointerPressed"
                                                            Tag="{Binding}"
                                                            behavior:TabDragBehavior.IsEnabled="True">
                                                            <Border.Transitions>
                                                                <Transitions>
                                                                    <BrushTransition Duration="0:0:0.2" Property="BorderBrush" />
                                                                    <!-- <BrushTransition Duration="0:0:0.2" Property="Background" /> -->
                                                                </Transitions>
                                                            </Border.Transitions>
                                                            <DockPanel Margin="8,-1,10,0" VerticalAlignment="Center">
                                                                <PathIcon
                                                                    Data="{Binding Icon}"
                                                                    Foreground="{DynamicResource TabTextColor}"
                                                                    Height="15"
                                                                    IsVisible="{Binding IconIsVisible}"
                                                                    Margin="0,0,4,0"
                                                                    Width="15" />
                                                                <ContentControl Content="{Binding HeaderContent}" Foreground="{DynamicResource TabTextColor}" />
                                                                <Grid
                                                                    HorizontalAlignment="Right"
                                                                    IsVisible="{Binding CanClose}"
                                                                    Margin="0,0,-4,0">
                                                                    <Button
                                                                        Classes="icon-button tab"
                                                                        Command="{Binding Close}"
                                                                        Content="{DynamicResource Close}"
                                                                        Foreground="{DynamicResource TabTextColor}"
                                                                        HorizontalAlignment="Right"
                                                                        Margin="3,1,0,0"
                                                                        MaxHeight="14"
                                                                        MaxWidth="16"
                                                                        MinHeight="14"
                                                                        Name="CloseButton"
                                                                        VerticalAlignment="Center">
                                                                        <Button.Transitions>
                                                                            <Transitions>
                                                                                <DoubleTransition Duration="0:0:0.07" Property="Opacity" />
                                                                            </Transitions>
                                                                        </Button.Transitions>
                                                                    </Button>
                                                                </Grid>
                                                            </DockPanel>
                                                        </Border>
                                                    </DataTemplate>
                                                </u:SelectionList.ItemTemplate>
                                            </u:SelectionList>
                                            <Button
                                                Classes="custom-hover-button tab"
                                                Content="{DynamicResource Plus}"
                                                Margin="4,0,0,0"
                                                Name="NewTabButton" />
                                        </StackPanel>
                                    </ScrollViewer>
                                </Grid>
                            </Border>
                            <DockPanel
                                Height="40"
                                HorizontalAlignment="Left"
                                IsHitTestVisible="False"
                                Margin="14,0,0,0"
                                Name="TitleRoot"
                                VerticalAlignment="Top">
                                <Image
                                    Height="24"
                                    Margin="0,0,0,0"
                                    VerticalAlignment="Center"
                                    Width="24">
                                    <Image.Source>
                                        <DrawingImage>
                                            <DrawingImage.Drawing>
                                                <DrawingGroup ClipGeometry="M0,0 V280 H280 V0 H0 Z">
                                                    <DrawingGroup Opacity="1">
                                                        <GeometryDrawing Brush="#FF5EB5EA" Geometry="F1 M280,280z M0,0z M77.63,91.65C79.43,88.07 81.59,83.62 86.04,83.01 92.99,82.2 100.01,82.9 107,82.62 111.24,82.76 116.37,81.99 119.63,85.38 122.69,88.72 124.58,92.93 126.33,97.06 123.54,104.05 119.23,110.26 115.88,116.96 109.81,129.28 103.19,141.31 97.12,153.63 90.79,164.97 85.34,176.77 79.19,188.21 77.31,191.47 75.92,195.54 72.4,197.41 68.11,198.9 63.46,198.23 59,198.34 53.75,198.14 48.38,198.92 43.21,197.73 38.91,196.07 35.62,192.25 33.85,188.07 32.19,184.32 34.59,180.56 36.15,177.25 50.16,148.8 63.77,120.16 77.63,91.65z" />
                                                        <GeometryDrawing Brush="#FF5EB5EA" Geometry="F1 M280,280z M0,0z M159.91,90.93C161.8,87.68 163.91,83.63 168.03,83.02 174.98,82.16 182.02,82.92 189,82.6 193.03,82.72 197.8,81.97 200.98,85.04 205.04,89.05 206.82,94.65 209.43,99.6 219.96,122.34 231,144.84 241.48,167.6 243.8,172.87 246.98,177.8 248.57,183.37 249.96,188.6 245.85,193.12 242.03,196.06 238.37,199.01 233.37,198.25 229,198.37 223.05,198.12 217.04,198.84 211.13,197.9 207.81,197.41 205.62,194.57 204.25,191.74 199.64,182.1 194.74,172.59 190.13,162.95 187.33,157.59 185.02,151.97 181.76,146.87 179.35,149.32 178.13,152.6 176.52,155.58 171.14,165.89 165.81,176.23 160.62,186.64 158.29,190.69 156.44,195.97 151.67,197.69 145.55,199.03 139.22,198.04 133,198.37 128.54,198.23 122.87,199.36 119.8,195.21 116.54,190.72 113.86,185.7 112.16,180.41 114.7,176.49 117.13,172.5 119.27,168.35 126.78,154.01 134.45,139.76 141.73,125.3 148.18,114.05 153.77,102.35 159.91,90.93z" />
                                                    </DrawingGroup>
                                                    <DrawingGroup Opacity="1">
                                                        <GeometryDrawing Brush="#FF9DD7F6" Geometry="F1 M280,280z M0,0z M126.33,97.06C131.69,106.34 135.74,116.37 141.73,125.3 134.45,139.76 126.78,154.01 119.27,168.35 117.13,172.5 114.7,176.49 112.16,180.41 106.5,171.85 102.97,162.07 97.12,153.63 103.19,141.31 109.81,129.28 115.88,116.96 119.23,110.26 123.54,104.05 126.33,97.06z" />
                                                    </DrawingGroup>
                                                </DrawingGroup>
                                            </DrawingImage.Drawing>
                                        </DrawingImage>
                                    </Image.Source>
                                </Image>
                                <TextBlock
                                    FontFamily="{DynamicResource MiSans}"
                                    FontSize="14"
                                    Foreground="{DynamicResource TabTextColor}"
                                    Margin="-1,0,0,0"
                                    Text="irel"
                                    VerticalAlignment="Center"
                                    x:Name="TitleText" />
                            </DockPanel>
                        </Grid>
                    </Border>
                    <ContentControl Content="{Binding SelectedTab.Content}" Name="Frame" />
                </DockPanel>
                <Border
                    Background="{DynamicResource WindowBackgroundColor}"
                    DockPanel.Dock="Bottom"
                    Height="1"
                    HorizontalAlignment="Center"
                    IsHitTestVisible="False"
                    Margin="0,50,0,0"
                    Name="FlyoutPoint"
                    Opacity="0"
                    VerticalAlignment="Top"
                    Width="1" />
                <u:OverlayDialogHost HostId="MainWindow" />
            </Grid>
        </DockPanel>
    </Border>
</u:UrsaWindow>
