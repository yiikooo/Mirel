<u:UrsaWindow
    Background="Transparent"
    CanMaximize="False"
    CanMinimize="True"
    CanResize="True"
    DragDrop.AllowDrop="True"
    FontFamily="{DynamicResource MiSans}"
    FontWeight="{DynamicResource FontWeight}"
    Icon="../../Icon.NoMargin.ico"
    IsCloseButtonVisible="False"
    IsFullScreenButtonVisible="False"
    IsHitTestVisible="True"
    IsManagedResizerVisible="False"
    IsTitleBarVisible="False"
    MinHeight="250"
    MinWidth="450"
    SystemDecorations="Full"
    Title="Aurelio"
    WindowStartupLocation="CenterScreen"
    d:DesignHeight="450"
    d:DesignWidth="800"
    mc:Ignorable="d"
    x:Class="Mirel.Views.Main.MainWindow"
    x:DataType="viewModels:MainViewModel"
    xmlns="https://github.com/avaloniaui"
    xmlns:behavior="clr-namespace:Mirel.Module.Behavior"
    xmlns:controls="clr-namespace:Mirel.Controls"
    xmlns:converter="clr-namespace:Mirel.Module.Converter"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:entries="clr-namespace:Mirel.Classes.Entries"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:u="https://irihi.tech/ursa"
    xmlns:viewModels="clr-namespace:Mirel.ViewModels"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <u:UrsaWindow.Resources>
        <converter:BoolReversalConverter x:Key="BoolReversalConverter" />
        <converter:NavScrollOpacityMaskConverter x:Key="NavScrollOpacityMaskConverter" />
    </u:UrsaWindow.Resources>
    <Border
        Background="{DynamicResource BackgroundColor}"
        BorderBrush="{DynamicResource PanelBorderBrush}"
        BorderThickness="1"
        ClipToBounds="True"
        CornerRadius="8"
        x:Name="Root">
        <DockPanel>
            <Border
                Background="{DynamicResource PanelBackgroundColor}"
                DockPanel.Dock="Bottom"
                Height="25"
                IsVisible="{Binding Data.SettingEntry.EnableBottomContainer}"
                Padding="5,3">
                <DockPanel>
                    <TextBlock
                        Classes="eq-width"
                        DockPanel.Dock="Left"
                        FontSize="12.5"
                        HorizontalAlignment="Left"
                        Text="{Binding SelectedTab.Content.ShortInfo}"
                        VerticalAlignment="Center" />
                    <TextBlock
                        Classes="eq-width"
                        DockPanel.Dock="Right"
                        FontSize="12.5"
                        HorizontalAlignment="Right"
                        Margin="0,0,3,0"
                        Text="{Binding Time}"
                        VerticalAlignment="Center" />
                    <ContentControl Content="{Binding SelectedTab.Content.BottomElement}" Margin="5,0" />
                </DockPanel>
            </Border>
            <Grid>
                <DockPanel>
                    <Border
                        ClipToBounds="True"
                        DockPanel.Dock="Top"
                        VerticalAlignment="Top">
                        <Grid Margin="3">
                            <controls:TitleBar
                                DockPanel.Dock="Top"
                                IsCloseBtnExitApp="True"
                                IsCloseBtnShow="True"
                                IsMaxBtnShow="True"
                                IsVisible="True"
                                Name="TitleBar">
                                <controls:TitleBar.LeftContent>
                                    <StackPanel Name="TitleBarContainer" Orientation="Horizontal">
                                        <Button
                                            Classes="title-bar-button big-title-bar-icon popup"
                                            Content="F1 M 10 21.796875 C 11.381836 21.796875 12.5 20.678711 12.5 19.296875 L 7.5 19.296875 C 7.5 20.678711 8.618164 21.796875 10 21.796875 Z M 18.413086 15.947266 C 17.661133 15.136719 16.245117 13.916016 16.245117 9.921875 C 16.245117 6.884766 14.121094 4.458008 11.25 3.862305 L 11.25 3.046875 C 11.25 2.358398 10.688477 1.796875 10 1.796875 C 9.311523 1.796875 8.75 2.358398 8.75 3.046875 L 8.75 3.862305 C 5.878906 4.458008 3.754883 6.884766 3.754883 9.921875 C 3.754883 13.916016 2.338867 15.136719 1.586914 15.947266 C 1.352539 16.201172 1.25 16.503906 1.25 16.796875 C 1.254883 17.436523 1.757812 18.046875 2.504883 18.046875 L 17.495117 18.046875 C 18.242188 18.046875 18.745117 17.436523 18.75 16.796875 C 18.75 16.503906 18.647461 16.201172 18.413086 15.947266 Z "
                                            Name="Bell"
                                            VerticalAlignment="Center">
                                            <Button.Flyout>
                                                <Flyout>
                                                    <Border
                                                        BorderThickness="1"
                                                        ClipToBounds="True"
                                                        Height="130"
                                                        Width="330" />
                                                </Flyout>
                                            </Button.Flyout>
                                        </Button>
                                        <Button
                                            Classes="title-bar-button big-title-bar-icon"
                                            Content="F1 M 1.25 8.671875 L 15.732422 8.671875 L 13.491211 10.913086 C 13.00293 11.401367 13.00293 12.192383 13.491211 12.680664 C 13.735352 12.924805 14.055138 13.046875 14.375 13.046875 C 14.694862 13.046875 15.014648 12.924805 15.258789 12.680664 L 19.633789 8.305664 C 20.12207 7.817383 20.12207 7.026367 19.633789 6.538086 L 15.258789 2.163086 C 14.770508 1.674805 13.979492 1.674805 13.491211 2.163086 C 13.00293 2.651367 13.00293 3.442383 13.491211 3.930664 L 15.732422 6.171875 L 1.25 6.171875 C 0.559044 6.171875 0 6.730919 0 7.421875 C 0 8.112831 0.559044 8.671875 1.25 8.671875 Z M 18.75 14.921875 L 4.267578 14.921875 L 6.508789 12.680664 C 6.99707 12.192383 6.99707 11.401367 6.508789 10.913086 C 6.020508 10.424805 5.229492 10.424805 4.741211 10.913086 L 0.366211 15.288086 C -0.12207 15.776367 -0.12207 16.567383 0.366211 17.055664 L 4.741211 21.430664 C 4.985352 21.674805 5.305138 21.796875 5.625 21.796875 C 5.944862 21.796875 6.264648 21.674805 6.508789 21.430664 C 6.99707 20.942383 6.99707 20.151367 6.508789 19.663086 L 4.267578 17.421875 L 18.75 17.421875 C 19.440956 17.421875 20 16.862831 20 16.171875 C 20 15.480919 19.440956 14.921875 18.75 14.921875 Z "
                                            Name="ASide"
                                            VerticalAlignment="Center" />
                                        <Separator
                                            Background="{DynamicResource TabTextColor}"
                                            Foreground="{DynamicResource TabTextColor}"
                                            Height="16"
                                            Margin="5,0,5,0"
                                            Name="Separator"
                                            VerticalAlignment="Center"
                                            Width="1" />
                                    </StackPanel>
                                </controls:TitleBar.LeftContent>
                            </controls:TitleBar>
                            <Border
                                Background="Transparent"
                                ClipToBounds="True"
                                DockPanel.Dock="Top"
                                Height="40"
                                HorizontalAlignment="Left"
                                Margin="80,0,150,0"
                                Name="NavRoot"
                                VerticalAlignment="Top">
                                <Grid>
                                    <ScrollViewer
                                        AllowAutoHide="True"
                                        HorizontalScrollBarVisibility="Auto"
                                        Name="NavScrollViewer"
                                        Offset="{Binding TabScrollOffset}"
                                        OpacityMask="{Binding IsTabMaskVisible, Converter={StaticResource NavScrollOpacityMaskConverter}}"
                                        PointerWheelChanged="NavScrollViewer_PointerWheelChanged"
                                        VerticalScrollBarVisibility="Disabled">
                                        <ScrollViewer.Styles>
                                            <Style Selector="ScrollViewer#NavScrollViewer /template/ ScrollBar#PART_HorizontalScrollBar:horizontal /template/ RepeatButton">
                                                <Setter Property="IsVisible" Value="False" />
                                            </Style>
                                            <Style Selector="ScrollViewer#NavScrollViewer /template/ ScrollBar#PART_HorizontalScrollBar:horizontal /template/ Thumb#thumb /template/ Border">
                                                <Setter Property="Height" Value="2" />
                                                <Setter Property="VerticalAlignment" Value="Bottom" />
                                            </Style>
                                        </ScrollViewer.Styles>
                                        <StackPanel Margin="0,0,20,0" Orientation="Horizontal">
                                            <u:SelectionList
                                                AutoScrollToSelectedItem="True"
                                                ItemsSource="{Binding Tabs}"
                                                Name="NavMenu"
                                                SelectedItem="{Binding SelectedTab, Mode=TwoWay}"
                                                VerticalAlignment="Center">
                                                <u:SelectionList.Styles>
                                                    <Style Selector="u|SelectionListItem:not(:selected)">
                                                        <Style Selector="^ TextBlock.tab">
                                                            <Setter Property="Foreground" Value="{DynamicResource TabTextColor}" />
                                                        </Style>
                                                        <Style Selector="^ PathIcon">
                                                            <Setter Property="Foreground" Value="{DynamicResource TabTextColor}" />
                                                        </Style>
                                                        <Style Selector="^ Button">
                                                            <Setter Property="Opacity" Value="0" />
                                                        </Style>
                                                        <Style Selector="^ Border#ItemRoot">
                                                            <Setter Property="Background" Value="{DynamicResource TabBackgroundColor}" />
                                                        </Style>
                                                    </Style>
                                                    <Style Selector="u|SelectionListItem:pointerover">
                                                        <Style Selector="^ Button">
                                                            <Setter Property="Opacity" Value="1" />
                                                        </Style>
                                                        <Style Selector="^ Border#ItemRoot">
                                                            <Setter Property="Background" Value="{DynamicResource HoverTabBackgroundColor}" />
                                                        </Style>
                                                    </Style>
                                                    <Style Selector="u|SelectionListItem:selected">
                                                        <Style Selector="^ TextBlock.tab">
                                                            <Setter Property="Foreground" Value="{DynamicResource SelectedTabTextColor}" />
                                                        </Style>
                                                        <Style Selector="^ PathIcon">
                                                            <Setter Property="Foreground" Value="{DynamicResource SelectedTabTextColor}" />
                                                        </Style>
                                                        <Style Selector="^ Button">
                                                            <Setter Property="Opacity" Value="1" />
                                                        </Style>
                                                        <Style Selector="^ Border#ItemRoot">
                                                            <Setter Property="Background" Value="{DynamicResource SelectedTabBackgroundColor}" />
                                                        </Style>
                                                    </Style>
                                                </u:SelectionList.Styles>
                                                <u:SelectionList.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <StackPanel Orientation="Horizontal" Spacing="5" />
                                                    </ItemsPanelTemplate>
                                                </u:SelectionList.ItemsPanel>
                                                <u:SelectionList.Indicator>
                                                    <Border IsVisible="False" />
                                                </u:SelectionList.Indicator>
                                                <u:SelectionList.ItemTemplate>
                                                    <DataTemplate DataType="entries:TabEntry">
                                                        <Border
                                                            BorderThickness="1"
                                                            CornerRadius="{DynamicResource CardCornerRadius}"
                                                            Height="30"
                                                            MinWidth="{Binding MinWidth}"
                                                            Name="ItemRoot"
                                                            PointerPressed="TabItem_OnPointerPressed"
                                                            Tag="{Binding}"
                                                            behavior:TabDragBehavior.IsEnabled="True">
                                                            <DockPanel Margin="8,-1,10,0" VerticalAlignment="Center">
                                                                <PathIcon
                                                                    Data="{Binding Icon}"
                                                                    Height="15"
                                                                    IsVisible="{Binding IconIsVisible}"
                                                                    Margin="0,0,4,0"
                                                                    Width="15" />
                                                                <Grid>
                                                                    <ContentControl
                                                                        Content="{Binding HeaderContent}"
                                                                        Foreground="{DynamicResource ForegroundColor}"
                                                                        IsVisible="{Binding IsUseHeaderContent}" />
                                                                    <TextBlock
                                                                        Classes="tab"
                                                                        IsVisible="{Binding IsUseHeaderContent, Converter={StaticResource BoolReversalConverter}}"
                                                                        Margin="2,0,0,0"
                                                                        Text="{Binding Title}" />
                                                                </Grid>
                                                                <Grid
                                                                    HorizontalAlignment="Right"
                                                                    IsVisible="{Binding CanClose}"
                                                                    Margin="0,0,-4,0">
                                                                    <Button
                                                                        Classes="icon-button tab"
                                                                        Command="{Binding Close}"
                                                                        Content="{DynamicResource Close}"
                                                                        HorizontalAlignment="Right"
                                                                        Margin="3,1,0,0"
                                                                        MaxHeight="14"
                                                                        MaxWidth="16"
                                                                        MinHeight="14"
                                                                        Name="CloseButton"
                                                                        VerticalAlignment="Center">
                                                                        <Button.Transitions>
                                                                            <Transitions>
                                                                                <DoubleTransition Duration="0:0:0.07" Property="Opacity" />
                                                                            </Transitions>
                                                                        </Button.Transitions>
                                                                    </Button>
                                                                </Grid>
                                                            </DockPanel>
                                                        </Border>
                                                    </DataTemplate>
                                                </u:SelectionList.ItemTemplate>
                                            </u:SelectionList>
                                            <Button
                                                Classes="custom-hover-button tab"
                                                Content="{DynamicResource Plus}"
                                                Margin="4,0,0,0"
                                                Name="NewTabButton" />
                                        </StackPanel>
                                    </ScrollViewer>
                                </Grid>
                            </Border>
                            <Border
                                CornerRadius="{DynamicResource CardCornerRadius}"
                                Height="30"
                                HorizontalAlignment="Left"
                                Margin="5,0,0,0"
                                Name="TitleRoot"
                                VerticalAlignment="Center"
                                Width="30">
                                <Border.Styles>
                                    <Style Selector="Border#TitleRoot">
                                        <Setter Property="Background" Value="{DynamicResource TabBackgroundColor}" />
                                    </Style>
                                    <Style Selector="Border#TitleRoot:pointerover">
                                        <Setter Property="Background" Value="{DynamicResource HoverTabBackgroundColor}" />
                                    </Style>
                                </Border.Styles>
                                <PathIcon
                                    Data="F1 M 17.012291 10.744324 C 17.638512 10.151176 17.665367 9.162521 17.071495 8.536415 C 16.477623 7.907867 15.488243 7.881012 14.862671 8.476601 L 10 13.082848 L 5.137329 8.476601 C 4.511147 7.882233 3.521767 7.90905 2.928505 8.536415 C 2.334633 9.162521 2.361488 10.151176 2.987709 10.744324 L 8.925171 16.368484 C 9.226685 16.654053 9.613647 16.796875 10 16.796875 C 10.386353 16.796875 10.773315 16.654053 11.074829 16.368484 Z "
                                    Foreground="{DynamicResource TabTextColor}"
                                    Height="12"
                                    HorizontalAlignment="Center"
                                    Margin="0,0,0,-2"
                                    VerticalAlignment="Center"
                                    Width="12" />
                            </Border>
                        </Grid>
                    </Border>
                    <ContentControl Content="{Binding SelectedTab.Content}" Name="Frame" />
                </DockPanel>
                <Border
                    Background="{DynamicResource BackgroundColor}"
                    DockPanel.Dock="Bottom"
                    Height="1"
                    HorizontalAlignment="Center"
                    IsHitTestVisible="False"
                    Margin="0,50,0,0"
                    Name="FlyoutPoint"
                    Opacity="0"
                    VerticalAlignment="Top"
                    Width="1" />
                <u:OverlayDialogHost HostId="MainWindow" />
            </Grid>
        </DockPanel>
    </Border>
</u:UrsaWindow>